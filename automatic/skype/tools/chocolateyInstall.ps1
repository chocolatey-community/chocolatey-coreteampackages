$ErrorActionPreference = 'Stop'

$terminateSkypeProcess = 'Get-Process -Name "Skype" | Stop-Process -Force'

$packageArgs = @{
  packageName    = $env:ChocolateyPackageName
  softwareName   = 'Skype*'
  url            = 'https://download.skype.com/s4l/download/win/Skype-8.47.0.59.exe'
  checksum       = '965cf724c5736ca5c79d75116bb3722816685025200985cdbba053f62f72e5ec'
  checksumType   = 'sha256'
  silentArgs     = "/VERYSILENT /SUPPRESSMSGBOXES /NORESTART /SP- /LOG=`"$($env:TEMP)\$($env:chocolateyPackageName).$($env:chocolateyPackageVersion).InnoInstall.log`""
  validExitCodes = @(0)
}

Install-ChocolateyPackage @packageArgs

Start-ChocolateyProcessAsAdmin -Statements $terminateSkypeProcess
